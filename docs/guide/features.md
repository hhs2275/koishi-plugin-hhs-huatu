# 功能介绍

HHS绘图插件基于 novelai-bot 二次开发，提供了丰富的功能增强。

## 🎨 角色提示词（Characters）

::: tip v4/v4.5 专属功能
支持为图像中的不同角色指定独立的提示词和位置。
:::

### 特性

- ✅ 支持多个角色独立设置
- ✅ 5×5 网格位置系统
- ✅ 支持角色独立的负向提示词
- ✅ 支持中英文分号分隔

### 快速示例

```bash
nai4 scene -K "1girl, red hair@B3;1boy, blue hair@D3"
```

[查看详细教程 →](/guide/characters)

---

## 📋 智能队列系统

解决多用户并发时的 429 错误问题。

### 特性

- ✅ 支持限制总队列数量
- ✅ 支持限制单用户队列数量
- ✅ 超出限制自动进入冷却
- ✅ 管理员可重置用户队列

### 管理指令

```bash
# 重置用户队列（需管理员权限）
novelai.reset-queue <用户ID>

# 查看队列状态
novelai.queue
```

[查看详细说明 →](/guide/queue)

---

## 🔄 便捷重画功能

一键重新生成之前的作品。

### 特性

- ✅ 支持多种指令格式
- ✅ 自动使用上次参数
- ✅ 支持重画 1-10 张

### 使用示例

```bash
重画          # 重画一张
重画一下      # 重画一张
重画两张      # 重画两张
重画 3        # 重画三张
重画2张       # 重画两张
```

---

## 👥 会员系统

完善的会员管理系统，支持差异化服务。

### 基础功能

- ✅ 会员权限管理
- ✅ 自动叠加会员时长
- ✅ 差异化每日限额和冷却时间
- ✅ 会员列表查看（支持分页）

### 高级功能

- ✅ 自动清理过期会员数据
- ✅ 到期提醒推送
- ✅ 调试工具（手动触发任务）

### 相关指令

```bash
会员                    # 查询自己状态
会员 -u <QQ号>          # 查询用户状态（需管理员）
会员 -u <QQ号> -d <天数> # 授予会员（需管理员）
会员 -u <QQ号> -c       # 取消会员（需管理员）
会员 -l                 # 查看会员列表
会员调试 -s             # 查看定时任务状态
会员调试 -c             # 执行清理任务
会员调试 -r             # 执行提醒任务
```

[查看详细说明 →](/guide/membership)

---

## 🛡️ 图片审核系统

自动审核生成的图片，过滤不当内容。

### 支持的审核引擎

- **腾讯云数据万象**：高精度、低延时
- **API4AI**：快速、易配置

### 特性

- ✅ 自动审核每张生成的图片
- ✅ 可配置审核失败处理方式
- ✅ 支持自动禁言违规用户
- ✅ 可指定审核的群组范围

### 配置选项

| 选项 | 说明 |
|------|------|
| 审核引擎 | 选择腾讯云或 API4AI |
| 失败处理 | 阻止发送 / 忽略错误 |
| 自动禁言 | 是否禁言违规用户 |
| 禁言时长 | 禁言的毫秒数 |
| 启用群组 | 指定需要审核的群 |

[查看配置教程 →](/guide/audit)

---

## 🖼️ 以图生图

支持 NovelAI 的图片转图片功能。

### 使用方法

```bash
# 发送图片 + 指令
[图片] nai portrait, detailed

# 调整重绘强度
[图片] nai landscape -N 0.7

# 调整噪声
[图片] nai scene -n 0.3
```

### 相关参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `-N` | 重绘强度 (0-1) | 0.7 |
| `-n` | 噪声强度 (0-1) | 0.2 |

---

## ⚙️ 其他功能

### 多模型支持

快捷指令直接调用不同模型：

```bash
nai     # 默认模型
nai4    # v4 Full
nai4c   # v4 Curated
nai4-5  # v4.5 Full
nai4-5c # v4.5 Curated
```

### 参数调整

```bash
# CFG Rescale 调整
nai scene -R 0.5

# 完整参数示例
nai4-5 masterpiece -r portrait -s k_euler_a -t 28 -c 5 -R 0.3
```

### 调试模式

在插件配置的「高级设置」中启用「调试日志」，可以看到：
- 角色提示词解析过程
- 图片审核详细信息
- API 请求参数

---

## 性能优化

### 队列系统

- 避免同时发送大量请求
- 自动排队处理任务
- 防止 API 限流

### Token 管理

- 支持配置多个 Token
- 支持多种使用策略：
  - 轮询策略
  - 随机策略
  - 备用策略
  - 并行策略

### 冷却机制

- 支持设置每次绘图的冷却时间
- 会员可享受更短的冷却时间
- 防止用户过度使用

---

## 下一步

- [学习角色提示词](/guide/characters)
- [配置会员系统](/guide/membership)
- [设置图片审核](/guide/audit)
- [查看配置选项](/guide/config)

